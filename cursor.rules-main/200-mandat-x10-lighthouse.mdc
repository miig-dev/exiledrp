---
description: Mandat X10 et Prompt Optimis√© V2 pour l'ex√©cution du Forfait Lighthouse 90+
globs: 
---

# Mandat X10 : Performance & Auditabilit√©

Ce document contient le prompt ma√Ætre et les standards √† appliquer pour toute t√¢che n√©cessitant une performance critique (Lighthouse 90+).

## üéØ Objectif
G√©n√©rer des structures de composants hautement performants en maximisant les Server Components et en minimisant l'hydratation client.

## ü§ñ Prompt Ma√Ætre (√Ä utiliser pour d√©l√©guer)

Copiez ce prompt pour lancer une t√¢che d'impl√©mentation :

> **Mandat d'Impl√©mentateur Next.js 15 Full-Stack :** Vous √™tes le d√©veloppeur sous mon audit strict. Vous devez g√©n√©rer **90% du code** en adh√©rant **sans compromis** aux standards X10 suivants pour la performance et l'auditabilit√© :
>
> **Stack X10 & Architecture :** Next.js 15 (App Router), TypeScript **strict**, Prisma, Shadcn UI, Radix UI, et Tailwind (Mobile-First).
> **Principes de Rendu (Audit-First) :** Maximiser **RSC** et **Server Actions**. Minimiser `'use client'` √† la stricte n√©cessit√© et l'encapsuler. Utiliser **Suspense** pour le streaming. Optimiser pour **LCP/CLS/FID**.
> **Convention :** R√©pertoires en `lowercase-with-dashes`. Composants en `export const MyComponent = (props: Props) => {}`. Utiliser `type` sur `interface`.
> **Data / State :** Utiliser **Prisma SDK** pour la base de donn√©es (PostgresQL). Utiliser **'nuqs'** pour la gestion de l'√©tat des param√®tres URL.
>
> **T√¢che √† Ex√©cuter (Forfait Lighthouse) :**
>
> G√©n√©rer la structure compl√®te du r√©pertoire `app/(main)/listings/` (ou autre feature) pour une page affichant une liste de donn√©es pagin√©e et filtr√©e. Cette structure doit inclure :
>
> 1.  Le fichier **`page.tsx`** (en **Server Component**) qui r√©cup√®re les donn√©es et les param√®tres de filtrage/pagination via `searchParams`. Il doit inclure `generateMetadata` pour un SEO dynamique bas√© sur les filtres.
> 2.  Le composant **`ProductListingsContainer`** (en **Server Component**) qui prend les donn√©es et les passe √† un sous-composant. **Il doit √™tre envelopp√© dans une `<Suspense>` avec un `Skeleton` adapt√© pour ne pas bloquer l'affichage initial des filtres (TTFB).**
> 3.  Le composant **`ClientFilterControls.tsx`** (marqu√© `'use client'`) qui g√®re les entr√©es utilisateur. Il doit utiliser **'nuqs'** pour l'URL et **`useTransition`** (ou l'√©tat de loading de nuqs) pour fournir un feedback visuel imm√©diat (ex: opacit√©) lors du filtrage (UX/INP).
> 4.  Le composant **`ProductCard`** (en **Server Component** ou minimal client). **Il doit accepter une prop `priority: boolean` pour forcer le chargement imm√©diat (`eager`) des images au-dessus de la ligne de flottaison (optimisation LCP).**
> 5.  Un sch√©ma Prisma optimis√© incluant les **index (`@@index`)** sur les colonnes filtrables pour garantir des requ√™tes rapides.
>
> **Objectif Final : Minimiser l'Hydratation, maximiser la performance c√¥t√© serveur et la s√©curit√© des types.**

## üìã Checklist de Validation X10

1. **Architecture Server-First :** `page.tsx` (Server) -> `ClientControls` (Client) -> `ListContainer` (Server).
2. **√âtat URL :** Utilisation exclusive de `nuqs` pour les filtres/pagination. Pas de `useState` complexe pour les donn√©es.
3. **Feedback UX :** Indicateur visuel (pending state) lors des transitions de filtres.
4. **LCP Optimis√© :** Images prioritaires (`priority={true}`) pour les √©l√©ments visibles au chargement.
5. **Base de Donn√©es :** Index pr√©sents sur les champs de recherche/filtre.
